From d0d42268e37d4946cff52b2f920c599b8916a927 Mon Sep 17 00:00:00 2001
From: Ignacio Casal Quinteiro <qignacio@amazon.com>
Date: Wed, 26 Feb 2020 12:05:03 +0100
Subject: [PATCH] meson: support debugoptimized

debugoptimized is like release with debug symbols
---
 meson.build | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/meson.build b/meson.build
index 2f6e38f..3ce5854 100644
--- a/meson.build
+++ b/meson.build
@@ -79,15 +79,21 @@ common_cflags = cc.get_supported_arguments(test_cflags)
 
 message('Building DCV Color Primitives')
 
+cargo_env = {}
+
 if get_option('buildtype') == 'release'
   dcp_build_dir = 'release'
   cargo_target = ['build', '--release', ]
+elif get_option('buildtype') == 'debugoptimized'
+  dcp_build_dir = 'release'
+  cargo_target = ['build', '--release', ]
+  cargo_env = { 'RUSTFLAGS': '-g' }
 else
   dcp_build_dir = 'debug'
   cargo_target = ['build', ]
 endif
 
-run_command('cargo', cargo_target)
+run_command('cargo', cargo_target, env: cargo_env)
 
 dcp_lib_path = meson.source_root() / 'target' / dcp_build_dir
 
-- 
2.17.1

