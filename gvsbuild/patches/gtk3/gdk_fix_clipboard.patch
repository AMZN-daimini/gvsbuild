From 22b091047f6a71670e0bcaad24c0ca5109a07279 Mon Sep 17 00:00:00 2001
From: Luca Bacci <luca.bacci982@gmail.com>
Date: Tue, 21 Mar 2023 10:34:32 +0100
Subject: [PATCH] GdkWin32: Zero-out memory of an allocated struct

Fixes https://gitlab.gnome.org/GNOME/gtk/-/issues/5678
---
 gdk/win32/gdkselection-win32.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/gdk/win32/gdkselection-win32.c b/gdk/win32/gdkselection-win32.c
index caa1a86a6de..04c7280f3ad 100644
--- a/gdk/win32/gdkselection-win32.c
+++ b/gdk/win32/gdkselection-win32.c
@@ -1968,10 +1968,10 @@ queue_open_clipboard (GdkWin32ClipboardQueueAction  action,
 	return;
     }

-  info = g_slice_new (GdkWin32ClipboardQueueInfo);
+  info = g_slice_new0 (GdkWin32ClipboardQueueInfo);

   info->display = display;
-  g_set_object (&info->requestor, requestor);
+  info->requestor = g_object_ref (requestor);
   info->selection = GDK_SELECTION_CLIPBOARD;
   info->target = target;
   info->idle_time = 0;
--
GitLab

